{"ruleId":"S3AccesslogEnabledForCloudtrail","ruleversion":"1.0","description":"Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket","disabled":false,"ruleDefinition":"@info(name = 'query1')from aws_s3 select json:toObject(awsS3) as obj insert into temp;from temp[json:isExists(obj,'$.awsS3.Logging.LoggingEnabled') == false] select json:getString(obj, '$.awsS3.ResourceType') as affected_resource_type, json:getString(obj, '$.awsS3.Details.Name') as affected_resource_name,json:isExists(obj,'$.awsS3.Logging.LoggingEnabled') as is_cloudtrail_log_enabled insert into s3_outputstream;","action":"add","type":["aws_s3"]}